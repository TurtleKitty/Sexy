
; Sexy core

; def

(def x 5)
(test 'def (= x 5))


; quote

(test 'quote-symbol (= (quote foo) 'foo))
(test 'quote-list (= (list 1 2 3) '(1 2 3)))


; if

(test 'if-true
    (if true
        true
        false))

(test 'if-false
    (if false
        false
        true))

; seq

(test 'seq-1
    (= (seq 1) 1))

(test 'seq-2
    (= (seq 1 2) 2))

(test 'seq-3
    (= (seq 1 2 3) 3))


; set!

(def mute 1)

(test 'set!
    (seq
        (set! mute 2)
        (= mute 2)))

(test 'set-other
    (seq
        (set! mute "I'm a string!")
        (= mute "I'm a string!")))

; fn

(test 'fn-identity
    (seq
        (def foo (fn (x) x))
        (= 'zebra (foo 'zebra))))

(test 'fn-add
    (seq
        (def bar (fn (x y) (+ x y)))
        (= 5 (bar 2 3))))

(test 'fn-recursion
    (seq
        (def fact
            (fn (n)
                (if (= n 1)
                    1
                    (* n (fact (- n 1))))))
        (= 120 (fact 5))))



; wall ?


; gate ?


; capture ?

